(require (lib "graphics.ss" "graphics"))



(define (laberinto)
  (open-graphics)
  (define ventana (open-viewport "juego" 1100 782));nombre de la ventana
  ((draw-pixmap ventana) "imagenes/e1.png" (make-posn 0 0))
  
;lo que mueve al jodido cuadrado
(cuadrado ventana 50 55 0);este es el cuadrado 
 (movercuadrado ventana 50 55 0) ;esto es lo que hace que lo mueva

  ((draw-line ventana) (make-posn 1046 56) (make-posn 1046 727) "black")
  
 )
;-----------------------------------------------
;funciones

;funfion1 (minerman derecha)
 (define (cuadrado ventana a b numer)
   (if (= numer 0)
   ((draw-pixmap ventana) "imagenes/m1.png" (make-posn a b))
   )

   (if (= numer 1)
   ((draw-solid-rectangle ventana)(make-posn a b) 23 44 "red")
   )
 )



 
;funcion 2 (lo que lo mueve)

 (define (movercuadrado ventana a b pres)
   
  (define pres 0)
  (set! pres (key-value (get-key-press ventana))); lo que hace que ud al oprimir una flecha
   ;el cuadrado verde se mueva en la direccion de la flecha
    
    (if (equal? pres 'right) ;si opime flecha a la DERECHA-- lateral derecho  columna-fila










        
        (begin
                    ;columna 1  eso es (a - 28) (b - 47)                       columna 2                                                coluimna 3
          (if (or (and (>= a 1020) (>= b 50) (<= b 725))       
                  (and (>= a 67) (<= a 143) (>= b 57) (<= b 154))          (and (>= a 163) (<= a 240) (>= b 57) (<= b 154))          (and (>= a 256) (<= a 336) (>= b 57) (<= b 154))
                  (and (>= a 67) (<= a 143) (>= b 166) (<= b 261))         (and (>= a 163) (<= a 240) (>= b 166) (<= b 261))         (and (>= a 256) (<= a 336) (>= b 166) (<= b 261))
                  (and (>= a 67) (<= a 143) (>= b 267) (<= b 365))         (and (>= a 163) (<= a 240) (>= b 267) (<= b 365))         (and (>= a 256) (<= a 336) (>= b 267) (<= b 365)) 
                  (and (>= a 67) (<= a 143) (>= b 373) (<= b 468))         (and (>= a 163) (<= a 240) (>= b 373) (<= b 468))         (and (>= a 256) (<= a 336) (>= b 373) (<= b 468))  
                  (and (>= a 67) (<= a 143) (>= b 476) (<= b 572))         (and (>= a 163) (<= a 240) (>= b 476) (<= b 573))         (and (>= a 256) (<= a 336) (>= b 476) (<= b 573)) 
                  (and (>= a 73) (<= a 143) (>= b 581) (<= b 678))         (and (>= a 163) (<= a 240) (>= b 581) (<= b 678))         (and (>= a 256) (<= a 336) (>= b 581) (<= b 678))


                   ;columna 4                                                columna 5                                                 columa 6 
                  (and (>= a 352) (<= a 430) (>= b 57) (<= b 154))          (and (>= a 448) (<= a 526) (>= b 57) (<= b 154))          (and (>= a 543) (<= a 621) (>= b 57) (<= b 154))
                  (and (>= a 352) (<= a 430) (>= b 166) (<= b 261))         (and (>= a 448) (<= a 526) (>= b 166) (<= b 261))         (and (>= a 543) (<= a 621) (>= b 166) (<= b 261))
                  (and (>= a 352) (<= a 430) (>= b 267) (<= b 365))         (and (>= a 448) (<= a 526) (>= b 267) (<= b 365))         (and (>= a 543) (<= a 621) (>= b 267) (<= b 365)) 
                  (and (>= a 352) (<= a 430) (>= b 373) (<= b 468))         (and (>= a 448) (<= a 526) (>= b 373) (<= b 468))         (and (>= a 543) (<= a 621) (>= b 373) (<= b 468))  
                  (and (>= a 352) (<= a 430) (>= b 476) (<= b 572))         (and (>= a 448) (<= a 526) (>= b 476) (<= b 573))         (and (>= a 543) (<= a 621) (>= b 476) (<= b 573)) 
                  (and (>= a 352) (<= a 430) (>= b 581) (<= b 678))         (and (>= a 448) (<= a 526) (>= b 581) (<= b 678))         (and (>= a 543) (<= a 621) (>= b 581) (<= b 678))


                   ;columna 7                                                columna 8                                                 columa 9 
                  (and (>= a 638) (<= a 714) (>= b 57) (<= b 154))          (and (>= a 733) (<= a 810) (>= b 57) (<= b 154))          (and (>= a 828) (<= a 906) (>= b 57) (<= b 154))
                  (and (>= a 638) (<= a 714) (>= b 166) (<= b 261))         (and (>= a 733) (<= a 810) (>= b 166) (<= b 261))         (and (>= a 828) (<= a 906) (>= b 166) (<= b 261))
                  (and (>= a 638) (<= a 714) (>= b 267) (<= b 365))         (and (>= a 733) (<= a 810) (>= b 267) (<= b 365))         (and (>= a 828) (<= a 906) (>= b 267) (<= b 365)) 
                  (and (>= a 638) (<= a 714) (>= b 373) (<= b 468))         (and (>= a 733) (<= a 810) (>= b 373) (<= b 468))         (and (>= a 828) (<= a 906) (>= b 373) (<= b 468))  
                  (and (>= a 638) (<= a 714) (>= b 476) (<= b 572))         (and (>= a 733) (<= a 810) (>= b 476) (<= b 573))         (and (>= a 828) (<= a 906) (>= b 476) (<= b 573)) 
                  (and (>= a 638) (<= a 714) (>= b 581) (<= b 678))         (and (>= a 733) (<= a 810) (>= b 581) (<= b 678))         (and (>= a 828) (<= a 906) (>= b 581) (<= b 678))


                  ;columna 10                                             
                  (and (>= a 923) (<= a 1000) (>= b 57) (<= b 154))        
                  (and (>= a 923) (<= a 1000) (>= b 166) (<= b 261))       
                  (and (>= a 923) (<= a 1000) (>= b 267) (<= b 365))       
                  (and (>= a 923) (<= a 1000) (>= b 373) (<= b 468))          
                  (and (>= a 923) (<= a 1000) (>= b 476) (<= b 572))         
                  (and (>= a 923) (<= a 1000) (>= b 581) (<= b 678))         
              )    



              (begin
                ()
                )

              
              (begin
                (cuadrado ventana a b 1)
                (cuadrado ventana (+ a 6) b 0)
                (movercuadrado ventana (+ a 6) b 0)
                )
              
          )
      )
    )    
    

   
     (if (equal? pres 'down) ;si oprime flecha ABAJO
         (begin
          (if (or (and (>= b 679) (>= a 50) (<= a 1046)) ;lateral inferior

                  ;Colummna 1                                                 ;Colummna 2                                              ;Colummna 3
                  (and (>= b 54)(<= b 160) (>= a 70) (<= a 142))             (and (>= b 54)(<= b 160) (>= a 166)(<= a 237))              (and (>= b 54)(<= b 160) (>= a 259) (<= a 334))
                  (and (>= b 160)(<= b 261) (>= a 70) (<= a 142))            (and (>= b 160)(<= b 261) (>= a 166) (<= a 237))            (and (>= b 160)(<= b 261) (>= a 259) (<= a 334))
                  (and (>= b 263)(<= b 365) (>= a 70) (<= a 142))            (and (>= b 263)(<= b 365) (>= a 166) (<= a 237))            (and (>= b 263)(<= b 365) (>= a 259) (<= a 334))
                  (and (>= b 366)(<= b 468) (>= a 70) (<= a 142))            (and (>= b 366)(<= b 468) (>= a 166) (<= a 237))            (and (>= b 366)(<= b 468) (>= a 259) (<= a 334))
                  (and (>= b 467)(<= b 572) (>= a 70) (<= a 142))            (and (>= b 467)(<= b 572) (>= a 166) (<= a 237))            (and (>= b 467)(<= b 572) (>= a 259) (<= a 334))
                  (and (>= b 575)(<= b 656) (>= a 75) (<= a 149))            (and (>= b 575)(<= b 656) (>= a 166) (<= a 237))            (and (>= b 575)(<= b 656) (>= a 259) (<= a 334))
                                                 
                                                                
                 ;Columna 4                                                    ;Columna 5                                               ;Columna 6 
                  (and (>= b 54) (<= b 160) (>= a 354) (<= a 429))           (and (>= b 54) (<= b 160) (>= a 451) (<= a 524))             (and (>= b 54) (<= b 160) (>= a 547) (<= a 620))
                  (and (>= b 160)(<= b 261) (>= a 354) (<= a 429))           (and (>= b 160)(<= b 261) (>= a 451) (<= a 524))             (and (>= b 160)(<= b 261) (>= a 547) (<= a 620))
                  (and (>= b 263)(<= b 365) (>= a 354) (<= a 429))           (and (>= b 263)(<= b 365) (>= a 451) (<= a 524))             (and (>= b 263)(<= b 365) (>= a 547) (<= a 620))
                  (and (>= b 366)(<= b 468) (>= a 354) (<= a 429))           (and (>= b 366)(<= b 468) (>= a 451) (<= a 524))             (and (>= b 366)(<= b 468) (>= a 547) (<= a 620))
                  (and (>= b 467)(<= b 572) (>= a 354) (<= a 429))           (and (>= b 467)(<= b 572) (>= a 451) (<= a 524))             (and (>= b 467)(<= b 572) (>= a 547) (<= a 620))
                  (and (>= b 575)(<= b 656) (>= a 354) (<= a 429))           (and (>= b 575)(<= b 656) (>= a 451) (<= a 524))             (and (>= b 575)(<= b 656) (>= a 547) (<= a 620))
                               
                  
                 ;Columna 7                                                    ;Columna 8                                               ;Columna 9 
                  (and (>= b 54) (<= b 160) (>= a 641) (<= a 714))           (and (>= b 54) (<= b 160) (>= a 737) (<= a 810))              (and (>= b 54) (<= b 160) (>= a 832) (<= a 905))
                  (and (>= b 160)(<= b 261) (>= a 641) (<= a 714))           (and (>= b 160)(<= b 261) (>= a 737) (<= a 810))              (and (>= b 160)(<= b 261) (>= a 832) (<= a 905))
                  (and (>= b 263)(<= b 365) (>= a 641) (<= a 714))           (and (>= b 263)(<= b 365) (>= a 737) (<= a 810))              (and (>= b 263)(<= b 365) (>= a 832) (<= a 905))
                  (and (>= b 366)(<= b 468) (>= a 641) (<= a 714))           (and (>= b 366)(<= b 468) (>= a 737) (<= a 810))              (and (>= b 366)(<= b 468) (>= a 832) (<= a 905))
                  (and (>= b 467)(<= b 572) (>= a 641) (<= a 714))           (and (>= b 467)(<= b 572) (>= a 737) (<= a 810))              (and (>= b 467)(<= b 572) (>= a 832) (<= a 905))
                  (and (>= b 575)(<= b 656) (>= a 641) (<= a 714))           (and (>= b 575)(<= b 656) (>= a 737) (<= a 810))              (and (>= b 575)(<= b 656) (>= a 832) (<= a 905))
            
                 
                 ;Columna 10 
                  (and (>= b 54) (<= b 160) (>= a 927) (<= a 1000))
                  (and (>= b 160)(<= b 261) (>= a 927) (<= a 1000))
                  (and (>= b 263)(<= b 365) (>= a 927) (<= a 1000))
                  (and (>= b 366)(<= b 468) (>= a 927) (<= a 1000))
                  (and (>= b 467)(<= b 572) (>= a 927) (<= a 1000))
                  (and (>= b 575)(<= b 656) (>= a 927) (<= a 1000))
              ) 


              (begin
                ()
                )
         
               (begin
                 (cuadrado ventana a b 1)
                (cuadrado ventana a (+ b 6) 0)
                (movercuadrado ventana a (+ b 6) 0)
                )

             
     )
      )
    )

   
      (if (equal? pres 'left); si oprime flecha a la IZQUIERDA

          (begin
          (if (or (and (<= a 53) (>= b 50) (<= b 727)) ;laterar izquierdo

                  ;columa 1                                                  columna 2                                                 columna 3                  
                  (and (>= a 94)  (<= a 146) (>= b 57)  (<= b 154))         (and (>= a 189) (<= a 243) (>= b 57) (<= b 154))          (and (>= a 283) (<= a 339) (>= b 57) (<= b 154))
                  (and (>= a 94)  (<= a 146) (>= b 166) (<= b 261))         (and (>= a 189) (<= a 243) (>= b 166) (<= b 261))         (and (>= a 283) (<= a 339) (>= b 166) (<= b 261))
                  (and (>= a 94)  (<= a 146) (>= b 267) (<= b 365))         (and (>= a 189) (<= a 243) (>= b 267) (<= b 365))         (and (>= a 283) (<= a 339) (>= b 267) (<= b 365)) 
                  (and (>= a 94)  (<= a 146) (>= b 373) (<= b 468))         (and (>= a 189) (<= a 243) (>= b 373) (<= b 468))         (and (>= a 283) (<= a 339) (>= b 373) (<= b 468))  
                  (and (>= a 94)  (<= a 146) (>= b 476) (<= b 572))         (and (>= a 189) (<= a 243) (>= b 476) (<= b 573))         (and (>= a 283) (<= a 339) (>= b 476) (<= b 573)) 
                  (and (>= a 100) (<= a 146) (>= b 581) (<= b 678))         (and (>= a 189) (<= a 243) (>= b 581) (<= b 678))         (and (>= a 283) (<= a 339) (>= b 581) (<= b 678))


                   ;columna 4                                                columna 5                                                 columa 6 
                  (and (>= a 379) (<= a 433) (>= b 57) (<= b 154))          (and (>= a 474) (<= a 531) (>= b 57) (<= b 154))          (and (>= a 570) (<= a 627) (>= b 57) (<= b 154))
                  (and (>= a 379) (<= a 433) (>= b 166) (<= b 261))         (and (>= a 474) (<= a 531) (>= b 166) (<= b 261))         (and (>= a 570) (<= a 627) (>= b 166) (<= b 261))
                  (and (>= a 379) (<= a 433) (>= b 267) (<= b 365))         (and (>= a 474) (<= a 531) (>= b 267) (<= b 365))         (and (>= a 570) (<= a 627) (>= b 267) (<= b 365)) 
                  (and (>= a 379) (<= a 433) (>= b 373) (<= b 468))         (and (>= a 474) (<= a 531) (>= b 373) (<= b 468))         (and (>= a 570) (<= a 627) (>= b 373) (<= b 468))  
                  (and (>= a 379) (<= a 433) (>= b 476) (<= b 572))         (and (>= a 474) (<= a 531) (>= b 476) (<= b 573))         (and (>= a 570) (<= a 627) (>= b 476) (<= b 573)) 
                  (and (>= a 379) (<= a 433) (>= b 581) (<= b 678))         (and (>= a 474) (<= a 531) (>= b 581) (<= b 678))         (and (>= a 570) (<= a 627) (>= b 581) (<= b 678))


                   ;columna 7                                                columna 8                                                 columa 9 
                  (and (>= a 665) (<= a 716) (>= b 57) (<= b 154))          (and (>= a 760) (<= a 812) (>= b 57) (<= b 154))          (and (>= a 856) (<= a 908) (>= b 57) (<= b 154))
                  (and (>= a 665) (<= a 716) (>= b 166) (<= b 261))         (and (>= a 760) (<= a 812) (>= b 166) (<= b 261))         (and (>= a 856) (<= a 908) (>= b 166) (<= b 261))
                  (and (>= a 665) (<= a 716) (>= b 267) (<= b 365))         (and (>= a 760) (<= a 812) (>= b 267) (<= b 365))         (and (>= a 856) (<= a 908) (>= b 267) (<= b 365)) 
                  (and (>= a 665) (<= a 716) (>= b 373) (<= b 468))         (and (>= a 760) (<= a 812) (>= b 373) (<= b 468))         (and (>= a 856) (<= a 908) (>= b 373) (<= b 468))  
                  (and (>= a 665) (<= a 716) (>= b 476) (<= b 572))         (and (>= a 760) (<= a 812) (>= b 476) (<= b 573))         (and (>= a 856) (<= a 908) (>= b 476) (<= b 573)) 
                  (and (>= a 665) (<= a 716) (>= b 581) (<= b 678))         (and (>= a 760) (<= a 812) (>= b 581) (<= b 678))         (and (>= a 856) (<= a 908) (>= b 581) (<= b 678))


                  ;columna 10                                             
                  (and (>= a 951) (<= a 1005) (>= b 57) (<= b 154))        
                  (and (>= a 951) (<= a 1005) (>= b 166) (<= b 261))       
                  (and (>= a 951) (<= a 1005) (>= b 267) (<= b 365))       
                  (and (>= a 951) (<= a 1005) (>= b 373) (<= b 468))          
                  (and (>= a 951) (<= a 1005) (>= b 476) (<= b 572))         
                  (and (>= a 951) (<= a 1005) (>= b 581) (<= b 678)) 
              ) 


              (begin
                ()
                )
          
               (begin
                 (cuadrado ventana a b 1)
                (cuadrado ventana (- a 6) b 0)
                (movercuadrado ventana (- a 6) b 0)
                )

                
      )
      )
    )          

       


    (if (equal? pres 'up); si oprime flecha ARRIBA

        (begin
          (if (or (and (<= b 55) (>= a 50) (<= a 1046)) ;lateral superior

                   ;Colummna 1                                               ;Colummna 2                                                   ;Colummna 3
                  (and (>= b 54)(<= b 160) (>= a 70) (<= a 142))             (and (>= b 54)(<= b 160) (>= a 166)(<= a 237))                (and (>= b 54)(<= b 160) (>= a 259) (<= a 334))
                  (and (>= b 160)(<= b 261) (>= a 70) (<= a 142))            (and (>= b 160)(<= b 261) (>= a 166) (<= a 237))              (and (>= b 160)(<= b 261) (>= a 259) (<= a 334))
                  (and (>= b 263)(<= b 365) (>= a 70) (<= a 142))            (and (>= b 263)(<= b 365) (>= a 166) (<= a 237))              (and (>= b 263)(<= b 365) (>= a 259) (<= a 334))
                  (and (>= b 366)(<= b 468) (>= a 70) (<= a 142))            (and (>= b 366)(<= b 468) (>= a 166) (<= a 237))              (and (>= b 366)(<= b 468) (>= a 259) (<= a 334))
                  (and (>= b 467)(<= b 572) (>= a 70) (<= a 142))            (and (>= b 467)(<= b 572) (>= a 166) (<= a 237))              (and (>= b 467)(<= b 572) (>= a 259) (<= a 334))
                  (and (>= b 575)(<= b 680) (>= a 75) (<= a 149))            (and (>= b 575)(<= b 680) (>= a 166) (<= a 237))              (and (>= b 575)(<= b 680) (>= a 259) (<= a 334))
                                                             
                  
                 ;Columna 4                                                   ;Columna 5                                                   ;Columna 6 
                  (and (>= b 54) (<= b 160) (>= a 354) (<= a 429))            (and (>= b 54) (<= b 160) (>= a 451) (<= a 524))             (and (>= b 54) (<= b 160) (>= a 547) (<= a 620))
                  (and (>= b 160)(<= b 261) (>= a 354) (<= a 429))            (and (>= b 160)(<= b 261) (>= a 451) (<= a 524))             (and (>= b 160)(<= b 261) (>= a 547) (<= a 620))
                  (and (>= b 263)(<= b 365) (>= a 354) (<= a 429))            (and (>= b 263)(<= b 365) (>= a 451) (<= a 524))             (and (>= b 263)(<= b 365) (>= a 547) (<= a 620))
                  (and (>= b 366)(<= b 468) (>= a 354) (<= a 429))            (and (>= b 366)(<= b 468) (>= a 451) (<= a 524))             (and (>= b 366)(<= b 468) (>= a 547) (<= a 620))
                  (and (>= b 467)(<= b 572) (>= a 354) (<= a 429))            (and (>= b 467)(<= b 572) (>= a 451) (<= a 524))             (and (>= b 467)(<= b 572) (>= a 547) (<= a 620))
                  (and (>= b 575)(<= b 680) (>= a 354) (<= a 429))            (and (>= b 575)(<= b 680) (>= a 451) (<= a 524))             (and (>= b 575)(<= b 680) (>= a 547) (<= a 620))
                                                  
                                    
                 ;Columna 7                                                   ;Columna 8                                                    ;Columna 9
                  (and (>= b 54) (<= b 160) (>= a 641) (<= a 714))            (and (>= b 54) (<= b 160) (>= a 737) (<= a 810))             (and (>= b 54) (<= b 160) (>= a 832) (<= a 905))
                  (and (>= b 160)(<= b 261) (>= a 641) (<= a 714))            (and (>= b 160)(<= b 261) (>= a 737) (<= a 810))             (and (>= b 160)(<= b 261) (>= a 832) (<= a 905))
                  (and (>= b 263)(<= b 365) (>= a 641) (<= a 714))            (and (>= b 263)(<= b 365) (>= a 737) (<= a 810))             (and (>= b 263)(<= b 365) (>= a 832) (<= a 905))
                  (and (>= b 366)(<= b 468) (>= a 641) (<= a 714))            (and (>= b 366)(<= b 468) (>= a 737) (<= a 810))             (and (>= b 366)(<= b 468) (>= a 832) (<= a 905))
                  (and (>= b 467)(<= b 572) (>= a 641) (<= a 714))            (and (>= b 467)(<= b 572) (>= a 737) (<= a 810))             (and (>= b 467)(<= b 572) (>= a 832) (<= a 905))
                  (and (>= b 575)(<= b 680) (>= a 641) (<= a 714))            (and (>= b 575)(<= b 680) (>= a 737) (<= a 810))             (and (>= b 575)(<= b 680) (>= a 832) (<= a 905))
                                
                  
                 ;Columna 10 
                  (and (>= b 54) (<= b 160) (>= a 927) (<= a 1000))
                  (and (>= b 160)(<= b 261) (>= a 927) (<= a 1000))
                  (and (>= b 263)(<= b 365) (>= a 927) (<= a 1000))
                  (and (>= b 366)(<= b 468) (>= a 927) (<= a 1000))
                  (and (>= b 467)(<= b 572) (>= a 927) (<= a 1000))
                  (and (>= b 575)(<= b 680) (>= a 927) (<= a 1000))
              ) 


              (begin
                ()
                )
        
             (begin
               (cuadrado ventana a b 1)
                (cuadrado ventana a (- b 6) 0)
                (movercuadrado ventana a (- b 6) 0)
                )

             
     )
      )
    ) 

   (movercuadrado ventana a b 0)
    
)
 
(laberinto)        
